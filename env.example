# Pivota Agent Gateway Configuration
# Copy this file to .env and fill in your actual values
# NEVER commit .env to version control

# Server Configuration
PORT=3000

# Pivota API Configuration
# Production: https://web-production-fedb.up.railway.app
# Replace with your actual Pivota API endpoint
PIVOTA_API_BASE=http://localhost:8080

# Your Pivota API Key from the Pivota console
# Keep this secret and secure!
PIVOTA_API_KEY=

# OpenAI Configuration (required for /ui/chat endpoint)
# Get your key from https://platform.openai.com/api-keys
OPENAI_API_KEY=

# Gateway Configuration
# The public URL where this gateway is deployed
PIVOTA_GATEWAY_URL=http://localhost:3000/agent/shop/v1/invoke

# Operation Mode
# Options: test, production
# Use 'test' for development with test merchants
# Use 'production' only when ready for real transactions
MODE=test

# API Mode Configuration
# Options: MOCK, HYBRID, REAL
# MOCK: Use internal mock data for all operations (default, good for demos)
# HYBRID: Real product search + mock payment (good for testing)
# REAL: Full real API integration (requires PIVOTA_API_KEY)
API_MODE=MOCK

# Legacy mock configuration (deprecated, use API_MODE instead)
USE_MOCK=false
MOCK_PIVOTA_PORT=8080

# Optional: Logging Configuration
# Options: debug, info, warn, error
LOG_LEVEL=info

# Optional: Test Merchant Configuration
# Used when MODE=test to avoid real transactions
TEST_MERCHANT_ID=
TEST_AGENT_ID=

# ---------------- Canonical Taxonomy (Creator Categories) ----------------
# Postgres connection string for pivota-agent-backend owned taxonomy + overrides.
DATABASE_URL=

# Optional DB connection tuning
DB_POOL_MAX=5
DB_SSL=false
DB_SSL_REJECT_UNAUTHORIZED=true

# Optional taxonomy knobs
TAXONOMY_VIEW_ID=GLOBAL_FASHION
TAXONOMY_DEFAULT_LOCALE=en-US
TAXONOMY_CACHE_TTL_MS=30000
TAXONOMY_VERSION=GLOBAL_FASHION@v1

# Safety valves
SKIP_DB_MIGRATIONS=false
CATEGORY_MIN_PRODUCT_COUNT=1

# Set to 'false' to force fallback to legacy merchant-derived categories.
TAXONOMY_ENABLED=true

# ---------------- Multilingual Vector Recall (Route B) ----------------
# Enable hybrid recall (lexical + vector) for creator cache search.
FIND_PRODUCTS_MULTI_VECTOR_ENABLED=false

# Embeddings provider config (Gemini recommended as multilingual default).
PIVOTA_EMBEDDINGS_PROVIDER=gemini
PIVOTA_EMBEDDINGS_FALLBACK_PROVIDER=

# Gemini embeddings
GEMINI_API_KEY=
GEMINI_BASE_URL=https://generativelanguage.googleapis.com
PIVOTA_EMBEDDINGS_MODEL_GEMINI=text-embedding-004

# OpenAI embeddings (optional)
PIVOTA_EMBEDDINGS_MODEL_OPENAI=text-embedding-3-small

# Embeddings runtime knobs
PIVOTA_EMBEDDINGS_CACHE_TTL_MS=300000
PIVOTA_EMBEDDINGS_MAX_CHARS=6000
PIVOTA_EMBEDDINGS_BATCH_SIZE=16
PIVOTA_EMBEDDINGS_UPSERT_BATCH_SIZE=32
